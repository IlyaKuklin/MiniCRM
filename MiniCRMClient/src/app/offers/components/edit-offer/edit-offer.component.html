<div class="offer">
  <div class="row offer_data">
    <div class="col-12">
      <mat-card style="display: flex" *ngIf="model.id">
        <mat-card-title class="offer_data_title">Номер КП: {{ model.number }}</mat-card-title>
        <div style="flex: 1"></div>
        <mat-card-title class="offer_data_title">Клиент: {{ model.client!.name }}</mat-card-title>
      </mat-card>
    </div>
  </div>

  <div class="row">
    <div class="col-6">
      <mat-card class="offer_card">
        <div class="offer_section">
          <mat-checkbox
            class="offer_section_cb"
            [ngClass]="{ 'faded-50': !isFieldSelected('description') }"
            [checked]="isFieldSelected('description')"
            (change)="onFieldSelectChange($event)"
            name="description"
          ></mat-checkbox>
          <mat-label [ngClass]="{ 'faded-50': !isFieldSelected('description') }"
            >Фотографии и описание товара</mat-label
          >
          <div class="offer_section__wrapper">
            <mat-form-field class="offer_section__wrapper__field">
              <textarea
                style="resize: none"
                [disabled]="!isFieldSelected('description')"
                rows="4"
                matInput
                [errorStateMatcher]="errorStateMatcher"
                type="text"
                [(ngModel)]="model.description"
                name="description"
                #description="ngModel"
              ></textarea>
            </mat-form-field>
          </div>
          <div class="offer_fieldWrapper">
            <input
              type="file"
              #audioFile
              placeholder="Choose file"
              style="display: none"
              accept=".mp3"
            />

            <button
              mat-raised-button
              class="form_upload__fileButton-btn"
              [disabled]="!isFieldSelected('description')"
            >
              Добавить фотографии
            </button>
          </div>
        </div>

        <div class="offer_section">
          <mat-checkbox
            class="offer_section_cb"
            [ngClass]="{ 'faded-50': !isFieldSelected('productSystemType') }"
            [checked]="isFieldSelected('productSystemType')"
            (change)="onFieldSelectChange($event)"
            name="productSystemType"
          ></mat-checkbox>
          <mat-label
            [ngClass]="{ 'faded-50': !isFieldSelected('productSystemType') }"
            >Тип системы/продукта</mat-label
          >
          <div class="offer_section__wrapper">
            <mat-form-field class="offer_section__wrapper__field">
              <input
                matInput
                [disabled]="!isFieldSelected('productSystemType')"
                [errorStateMatcher]="errorStateMatcher"
                type="text"
                [(ngModel)]="model.productSystemType"
                name="productSystemType"
                #productSystemType="ngModel"
              />
            </mat-form-field>
          </div>
        </div>

        <div class="offer_section">
          <mat-checkbox
            class="offer_section_cb"
            [ngClass]="{
              'faded-50': !isFieldSelected('briefIndustryDescription')
            }"
            [checked]="isFieldSelected('briefIndustryDescription')"
            (change)="onFieldSelectChange($event)"
            name="briefIndustryDescription"
          ></mat-checkbox>
          <mat-label
            [ngClass]="{
              'faded-50': !isFieldSelected('briefIndustryDescription')
            }"
            >Краткое описание отрасли клиента</mat-label
          >
          <div class="offer_section__wrapper">
            <mat-form-field class="offer_section__wrapper__field">
              <textarea
                style="resize: none"
                rows="4"
                [disabled]="!isFieldSelected('briefIndustryDescription')"
                matInput
                [errorStateMatcher]="errorStateMatcher"
                type="text"
                [(ngModel)]="model.briefIndustryDescription"
                name="briefIndustryDescription"
                #briefIndustryDescription="ngModel"
              ></textarea>
            </mat-form-field>
          </div>
        </div>

        <div class="offer_section">
          <mat-checkbox
            class="offer_section_cb"
            [ngClass]="{ 'faded-50': !isFieldSelected('offerCase') }"
            [checked]="isFieldSelected('offerCase')"
            (change)="onFieldSelectChange($event)"
            name="offerCase"
          ></mat-checkbox>
          <mat-label [ngClass]="{ 'faded-50': !isFieldSelected('offerCase') }"
            >Кейс</mat-label
          >
          <div class="offer_section__wrapper">
            <mat-form-field class="offer_section__wrapper__field">
              <textarea
                style="resize: none"
                rows="4"
                [disabled]="!isFieldSelected('offerCase')"
                matInput
                [errorStateMatcher]="errorStateMatcher"
                type="text"
                [(ngModel)]="model.offerCase"
                name="offerCase"
                #offerCase="ngModel"
              ></textarea>
            </mat-form-field>
          </div>
        </div>
      </mat-card>
    </div>
    <!-- end col -->

    <div class="col-6">
      <mat-card class="offer_card"></mat-card>
    </div>
  </div>

  <div class="row justify-content-end">
    <div class="col-4 offer_form__buttons">
      <button
        mat-raised-button
        (click)="submit()"
        color="primary"
        *ngIf="!isEdit"
      >
        Создать
      </button>

      <div *ngIf="isEdit && !isLoading" class="offer_form__buttons-edit">
        <button
          mat-raised-button
          color="primary"
          class="offer_form__buttons-button"
          [disabled]="!modelChanged"
          (click)="update()"
        >
          Обновить
        </button>
        <button
          mat-raised-button
          color="warn"
          class="offer_form__buttons-button"
          (click)="delete()"
        >
          Удалить
        </button>
      </div>
    </div>
  </div>
</div>

<div class="loader" *ngIf="isLoading">
  <mat-spinner></mat-spinner>
</div>
